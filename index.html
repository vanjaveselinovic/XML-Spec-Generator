<!DOCTYPE html>
<html>
	<head>
		<title>XML Spec Generator</title>

		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

		<script>
			 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			 ga('create', 'UA-83080710-1', 'auto');
			 ga('send', 'pageview');
		</script>

		<script type="text/javascript">

			$(document).ready(function () {

				/* General */

				var currentStep = 1;

				$('.sidebar-step').click(function (ev) {
					var el = $(ev.target);

					$('.sidebar-step').removeClass('current-step');
					if(el.hasClass('sidebar-step'))
						el.addClass('current-step');
					else
						$(el[0].parentElement).addClass('current-step');

					if (el.is('#step1') || $(el[0].parentElement).is('#step1')) {
						$('body').removeClass('page2 page3 page4');
						$('body').addClass('page1');

						ga('send', 'event', 'Sidebar', 'click', 'step1');
					}
					else if (el.is('#step2') || $(el[0].parentElement).is('#step2')) {
						$('body').removeClass('page1 page3 page4');
						$('body').addClass('page2');

						ga('send', 'event', 'Sidebar', 'click', 'step2');
					}
					else if (el.is('#step3') || $(el[0].parentElement).is('#step3')) {
						$('body').removeClass('page1 page2 page4');
						$('body').addClass('page3');

						ga('send', 'event', 'Sidebar', 'click', 'step3');
					}
					else if (el.is('#step4') || $(el[0].parentElement).is('#step4')) {
						$('body').removeClass('page1 page2 page3');
						$('body').addClass('page4');

						ga('send', 'event', 'Sidebar', 'click', 'step4');
					}
				});

				/* STEP 1 Generate */

				/* STEP 2 Build */

				var deletedAttributes = [];

				function getAttributes(oDOM) {
					var attributes = [];

					var elements = oDOM.getElementsByTagName("*");

					var element;
					for (var i = 0; i < elements.length; i++) {

						element = $(elements[i])[0];
						if (element.children.length === 0) {
							attributes.push({
								tag: element.tagName,
								val: element.textContent
							});
						}
					}

					return attributes;
				}

				function apRow(tag, val) {
					return '<div class="ap-row"><div class="ap-col ap-col-tag"><input type="text" value="'+tag+'"></div><div class="ap-col ap-col-val"><input type="text" value="'+val+'"><i class="material-icons no-highlight">delete</i></div></div>';
				}

				function addApRow(tag, val) {
					$('#ap-main').append(apRow(tag, val));
					
					$('.ap-row:last-of-type .ap-col-val i').click(function (ev) {
						var el = $(ev.target);

						deletedAttributes.push(apRow(el[0].parentElement.previousSibling.children[0].text, el[0].previousSibling.text));

						$(el[0].parentElement.parentElement).remove();

						ga('send', 'event', 'Step 2 Build', 'click', 'remove attribute');
					});
				};

				$('#generate-button').click(function () {

					var oParser = new DOMParser();
					var oDOM = oParser.parseFromString($('#rule-xml').val().trim(), "text/xml");

					if ($('#rule-name').val() !== ''
						&& $('#rule-desc').val() !== ''
						&& $(oDOM.documentElement)[0].outerHTML.indexOf('parsererror') === -1) {

						$('#attributes-panel').removeClass('disabled-div');

						var attributes = getAttributes(oDOM);

						for(var i = 0; i < attributes.length; i++) {
							addApRow(attributes[i]['tag'], attributes[i]['val']);
						}

						ga('send', 'event', 'Step 2 Build', 'generation', 'success');
					}
					else {
						if($('#rule-name').val() === '') {
							$('#rule-name').addClass('invalid-input');
							ga('send', 'event', 'Step 2 Build', 'generation', 'failure - no title');
						}
						if ($('#rule-desc').val() === '') {
							$('#rule-desc').addClass('invalid-input');
							ga('send', 'event', 'Step 2 Build', 'generation', 'failure - no description');
						}
						if ($(oDOM.documentElement)[0].outerHTML.indexOf('parsererror') !== -1) {
							$('#rule-xml').addClass('invalid-input');
							ga('send', 'event', 'Step 2 Build', 'generation', 'failure - no/invalid xml');
						}
					}

					ga('send', 'event', 'Step 2 Build', 'click', 'generate attributes');
				});

				$('#ap-footer').click(function () {
					addApRow('', '');

					var apMainViewport = document.getElementById("ap-main");
					apMainViewport.scrollTop = apMainViewport.scrollHeight;
				});

				/* STEP 3 Test */

				/* STEP 4 Submit */
	
			});
		</script>

		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

		<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Slabo+27px" rel="stylesheet">

		<style>
			* {
				box-sizing: border-box;
			}

			body {
				margin: 0;
				padding: 0;
				font-family: 'Open Sans', sans-serif;
				background: #eeeeee;
			}

			textarea {
				resize: none;
			}

			i {
				font-size: inherit !important;
			}

			.small {
				font-size: 0.7em;
			}

			input[type="text"] {
				border: 0;
				border-bottom: 1px solid rgba(0,0,0,0.15);
				padding-bottom: 5px;
			}

			input[type="text"]:focus {
				outline: none;
			}

			button {
				border: none;
				color: white;
				border-radius: 2px;
			}

			button:focus {
				outline: none;
			}

			button:active {
				outline: none;
			}

			input, textarea, keygen, select, button {
				font-family: 'Open Sans', sans-serif;
			}

			.disabled-div {
				pointer-events: none;
				opacity: 0.4;
			}

			.invalid-input {
			}

			.no-highlight {
				cursor: default;
				-webkit-user-select: none; /* Chrome/Safari/Opera */
  				-moz-user-select: none; /* Firefox */
  				-ms-user-select: none; /* Internet Explorer/Edge */
  				user-select: none;
			}

			#sidebar {
				position: fixed;
				width: 150px;
				height: 100%;
				z-index: 1;
				color: white;
			}

			#sidebar-top {
				height: 150px;
				line-height: 150px;
				text-align: center;
				font-family: 'Slabo 27px', monospace;
			}

			.sidebar-step {
				text-align: center;
				padding: 20px 0;
				position: relative;
				cursor: default;
				-webkit-user-select: none; /* Chrome/Safari/Opera */
  				-moz-user-select: none; /* Firefox */
  				-ms-user-select: none; /* Internet Explorer/Edge */
  				user-select: none;
			}

			.sidebar-step h4, .sidebar-step h3 {
				font-weight: normal;
				line-height: 1;
				margin: 0;
				padding: 0;
			}

			.sidebar-step h4 {
				text-transform: uppercase;
				font-size: 0.8em;
				font-family: 'Slabo 27px', monospace;
			}

			.sidebar-step h3 {
				margin-top: 5px;
			}

			.current-step:after {
				content: ' ';
				position: absolute;
				right: 0;
				top: 50%;
				transform: translate(0, -50%);
				border-top: 10px solid transparent;
				border-right: 10px solid #eee;
				border-bottom: 10px solid transparent;
			}

			.current-step h4 {
				font-weight: bold;
			}

			.current-step h3 {
				color: white !important;
			}

			#sidebar-bottom {
				font-size: 0.7em;
				text-align: center;
				margin-top: 30px;
				position: absolute;
				width: 100%;
				bottom: 30px;
			}

			#sidebar-bottom span:hover {
				color: white;
				text-decoration: underline;
			}

			#wrapper {
				position: absolute;
				width: calc(100% - 150px);
				height: 100%;
				right: 0;
			}

			#wrapper h2 {
				font-family: 'Slabo 27px', monospace;
				margin-top: 0;
				margin-bottom: 0;
			}

			.page {
				height: 100%;
				right: 0;
				display: flex;
				flex-flow: column;
				padding: 50px 0;
			}

			.page-scrollable {
				height: initial;
			}

			.section {
				max-width: 600px;
				width: calc(100% - 40px);
				margin: 0 auto;
				flex: 0 1 auto;
				margin-bottom: 30px !important;
				box-sizing: content-box;
			}

			.section:last-of-type {
				margin-bottom: 0 !important;
			}

			.section-center {
				text-align: center;
			}

			.section-fill {
				flex: 1 1 auto;
			}

			.section-panel {
				background: white;
				box-shadow: 0 0 20px rgba(0,0,0,0.1);
				padding: 20px;
			}

			.no-padding {
				padding: 0 !important;
			}

			.instruction {
				display: table-row;
			}

			.instruction h3 {
				font-size: 0.7em;
				width: 50px;
				height: 50px;
				line-height: 50px;
				text-align: center;
				float: left;
				margin-right: 10px;
				box-sizing: content-box;
				text-transform: uppercase;
				border: 1px solid;
			}

			#paste-panel {
				height: 150px;
			}

			#pp-left, #pp-right {
				height: 100%;
				float: left;
				padding: 10px;
			}

			#pp-left {
				width: 35%;
				border-right: 1px solid rgba(0,0,0,0.15);
				display: flex;
				flex-flow: column;
			}

			#pp-right {
				width: 65%;
			}

			#rule-name {
				width: 100%;
				font-size: 1em;
				flex: 0 1 auto;
				margin-bottom: 5px;
			}

			#rule-desc {
				width: 100%;
				height: 100%;
				flex: 1 1 auto;
				border: none;
			}

			#rule-desc:focus {
				outline: none;
			}

			#rule-xml {
				width: 100%;
				height: 100%;
				border: none;
				font-family: monospace;
			}

			#rule-xml:focus {
				outline: none;
			}

			#generate-button {
				font-size: 1em;
				padding: 0 20px;
				height: 40px;
				line-height: 40px;
				box-shadow: 0 0 10px rgba(0,0,0,0.2);
			}

			#generate-button:focus {
				box-shadow: 0 0 10px rgba(0,0,0,0.5);
			}

			#generate-button:active {
				box-shadow: 0 0 10px rgba(0,0,0,0.5);
			}

			#attributes-panel {
				height: calc(100% - 300px);
				min-height: 179px;
				display: flex;
				flex-flow: column;
				box-sizing: border-box;
				padding: 0;
			}

			.header, .ap-row, #ap-footer {
				height: 40px;
				line-height: 40px;
			}

			.header {
				background: rgba(0,0,0,0.05);
				color: grey;
				font-weight: lighter;
			}

			.header i, #ap-footer i {
				position: absolute;
				line-height: 40px;
			}

			.header span, #ap-footer span {
				padding-left: 20px;
			}

			#ap-header {
				flex: 0 1 auto;
			}

			#ap-main {
				flex: 1 1 auto;
				overflow: auto;
			}

			.ap-row {
				width: 100%;
				border-bottom: 1px solid rgba(0,0,0,0.1);
			}

			.ap-col {
				width: 50%;
				float: left;
				padding-left: 10px;
				height: 100%;				
			}

			.ap-col-tag input[type="text"] {
				width: calc(100% - 15px);
			}

			.ap-col-val input[type="text"] {
				width: calc(100% - 35px);
			}

			.ap-col-val i {
				margin-left: 10px;
				color: rgba(0,0,0,0.3);
			}

			#ap-footer {
				flex: 0 1 auto;
				color: white;
				padding: 0 10px;
			}

			/* page1 colors */

			.page1 input[type="text"]:focus,
			.page1 .instruction h3 {
				border-color: hsl(20, 100%, 55%);
			}

			.page1 #sidebar {
				background: hsl(20, 100%, 40%);
			}

			.page1 #sidebar-top,
			.page1 .sidebar-step {
				border-bottom: 1px solid hsl(20, 100%, 35%);
			}

			.page1 .sidebar-step:hover {
				background: hsl(20, 100%, 38%);
			}

			.page1 .sidebar-step h4 {
				color: hsl(20, 100%, 30%);
			}

			.page1 .sidebar-step h3,
			.page1 #sidebar-bottom,
			.page1 #wrapper h2,
			.page1 .ap-col-val i:hover,
			.page1 .instruction h3 {
				color: hsl(20, 100%, 50%);
			}

			.page1 .current-step,
			.page1 .current-step:hover {
				background: hsl(20, 100%, 35%);
			}

			.page1 .current-step h4 {
				color: hsl(20, 100%, 20%);
			}

			.page1 #rule-desc:focus,
			.page1 #rule-xml:focus {
				background: hsl(20, 100%, 98%);
			}

			.page1 button,
			.page1 #ap-footer {
				background: hsl(20, 100%, 50%);
			}

			.page1 button:active,
			.page1 #ap-footer:hover {
				background: hsl(20, 100%, 45%);
			}

			/* page2 colors */

			.page2 input[type="text"]:focus,
			.page2 .instruction h3 {
				border-color: hsl(336, 100%, 55%);
			}

			.page2 #sidebar {
				background: hsl(336, 100%, 40%);
			}

			.page2 #sidebar-top,
			.page2 .sidebar-step {
				border-bottom: 1px solid hsl(336, 100%, 35%);
			}

			.page2 .sidebar-step:hover {
				background: hsl(336, 100%, 38%);
			}

			.page2 .sidebar-step h4 {
				color: hsl(336, 100%, 30%);
			}

			.page2 .sidebar-step h3,
			.page2 #sidebar-bottom,
			.page2 #wrapper h2,
			.page2 .ap-col-val i:hover,
			.page2 .instruction h3 {
				color: hsl(336, 100%, 50%);
			}

			.page2 .current-step,
			.page2 .current-step:hover {
				background: hsl(336, 100%, 35%);
			}

			.page2 .current-step h4 {
				color: hsl(336, 100%, 20%);
			}

			.page2 #rule-desc:focus,
			.page2 #rule-xml:focus {
				background: hsl(336, 100%, 98%);
			}

			.page2 button,
			.page2 #ap-footer {
				background: hsl(336, 100%, 50%);
			}

			.page2 button:active,
			.page2 #ap-footer:hover {
				background: hsl(336, 100%, 45%);
			}

			/* page3 colors */

			.page3 input[type="text"]:focus,
			.page3 .instruction h3 {
				border-color: hsl(43, 100%, 55%);
			}

			.page3 #sidebar {
				background: hsl(43, 100%, 40%);
			}

			.page3 #sidebar-top,
			.page3 .sidebar-step {
				border-bottom: 1px solid hsl(43, 100%, 35%);
			}

			.page3 .sidebar-step:hover {
				background: hsl(43, 100%, 38%);
			}

			.page3 .sidebar-step h4 {
				color: hsl(43, 100%, 30%);
			}

			.page3 .sidebar-step h3,
			.page3 #sidebar-bottom,
			.page3 #wrapper h2,
			.page3 .ap-col-val i:hover,
			.page3 .instruction h3 {
				color: hsl(43, 100%, 50%);
			}

			.page3 .current-step,
			.page3 .current-step:hover {
				background: hsl(43, 100%, 35%);
			}

			.page3 .current-step h4 {
				color: hsl(43, 100%, 20%);
			}

			.page3 #rule-desc:focus,
			.page3 #rule-xml:focus {
				background: hsl(43, 100%, 98%);
			}

			.page3 button,
			.page3 #ap-footer {
				background: hsl(43, 100%, 50%);
			}

			.page3 button:active,
			.page3 #ap-footer:hover {
				background: hsl(43, 100%, 45%);
			}

			/* page4 colors */

			.page4 input[type="text"]:focus,
			.page4 .instruction h3 {
				border-color: hsl(208, 100%, 55%);
			}

			.page4 #sidebar {
				background: hsl(208, 100%, 40%);
			}

			.page4 #sidebar-top,
			.page4 .sidebar-step {
				border-bottom: 1px solid hsl(208, 100%, 35%);
			}

			.page4 .sidebar-step:hover {
				background: hsl(208, 100%, 38%);
			}

			.page4 .sidebar-step h4 {
				color: hsl(208, 100%, 30%);
			}

			.page4 .sidebar-step h3,
			.page4 #sidebar-bottom,
			.page4 #wrapper h2,
			.page4 .ap-col-val i:hover,
			.page4 .instruction h3 {
				color: hsl(208, 100%, 50%);
			}

			.page4 .current-step,
			.page4 .current-step:hover {
				background: hsl(208, 100%, 35%);
			}

			.page4 .current-step h4 {
				color: hsl(208, 100%, 20%);
			}

			.page4 #rule-desc:focus,
			.page4 #rule-xml:focus {
				background: hsl(208, 100%, 98%);
			}

			.page4 button,
			.page4 #ap-footer {
				background: hsl(208, 100%, 50%);
			}

			.page4 button:active,
			.page4 #ap-footer:hover {
				background: hsl(208, 100%, 45%);
			}

		</style>
	</head>

	<body class="page1">
		<div id="sidebar">
			<div id="sidebar-top">Spec Builder</div>
			<div class="sidebar-step current-step" id="step1">
				<h4>Step 1</h4>
				<h3>Generate</h3>
			</div>
			<div class="sidebar-step" id="step2">
				<h4>Step 2</h4>
				<h3>Build</h3>
			</div>
			<div class="sidebar-step" id="step3">
				<h4>Step 3</h4>
				<h3>Test</h3>
			</div>
			<div class="sidebar-step" id="step4">
				<h4>Step 4</h4>
				<h3>Submit</h3>
			</div>
			<div id="sidebar-bottom" class="no-highlight"><span>About</span></div>
		</div>
		<div id="wrapper">
			<div class="page page-scrollable">
				<div class="section small">
					<h2>CloudSpeX</h2>
					<p>Signiant's CloudSpeX application dramatically lowers rejection rates associated with the receipt of improperly formatted files, and helps to manage the volume and complexity of today's multiplatform delivery specifications.</p>
					<p>Unlike other solutions that validate format compliance after the file transfer, CloudSpeX ensures that your delivery specification is enforced prior to delivery to save significant time and resources.</p>
					<p>CloudSpeX is built-in to Signiant's Media Shuttle product.</p>
				</div>
				<div class="section section-panel">
					<h2>Spec Builder</h2>
					<p>Version 1.0 (current) - Builds <strong>file</strong> rules - which specify the technical data an uploaded file must include.</p>
					<p class="small">Future Versions - Build <strong>package</strong> rules - which specify how many files and which type an uploaded package of files must contain (e.g. 1 or more .mov files and 5 .jpeg files).</p>
					<p>
				</div>
				<div class="section section-panel">
					<h2>How to use this tool</h2>
					<div class="instruction">
						<h3>Step 1</h3>
						<p>Upload a small file that conforms to the specification you want to support.</p>
					</div>
					<div class="instruction">
						<h3>Step 2</h3>
						<p>Edit the .XML</p>
					</div>
					<div class="instruction">
						<h3>Step 3</h3>
						<p>Test it (with other files that either conform or fail to make your edited specification). If necessary, go back to Step 1 or 2 and make adjustments.</p>
					</div>
					<div class="instruction">
						<h3>Step 4</h3>
						<p>Submit your completed spec to Signiant.</p>
					</div>
				</div>
			</div>
			<div class="page">
				<div id="paste-panel" class="section section-panel no-padding">
					<div id="pp-left">
						<input type="text" id="rule-name" placeholder="Rule name"></input>
						<textarea id="rule-desc" placeholder="Rule description"></textarea>
					</div>
					<div id="pp-right">
						<textarea id="rule-xml" placeholder="Paste valid MediaInfo XML here"></textarea>
					</div>
				</div>
				<div class="section section-center">
					<button id="generate-button">Generate</button>
				</div>
				<div id="attributes-panel" class="section section-panel section-fill disabled-div">
					<div id="ap-header" class="header">
						<div class="ap-col">
							<i class="material-icons">label</i>
							<span>Tag</span>
						</div>
						<div class="ap-col">
							<i class="material-icons">border_color</i>
							<span>Value</span>
						</div>
					</div>
					<div id="ap-main">
					</div>
					<div id="ap-footer" class="no-highlight">
						<i class="material-icons">add_circle</i>
						<span>Add new attribute</span>
					</div>
				</div>
			</div>
			<div class="page">
				<div class="section section-panel section-fill">
					Test your spec
				</div>
			</div>
			<div class="page">
				<div class="section section-panel section-fill">
					Submit your spec for consideration
				</div>
			</div>
		</div>
	</body>
</html>